<!DOCTYPE html>
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<!-- link to MathJax for LaTeX stlye eqn -->
	 <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
</script>

	 
	 <!-- https://realfavicongenerator.net -->
	 <link rel="apple-touch-icon" sizes="180x180" href="/images/logos/favicon_package_v0.16_bw/apple-touch-icon.png">
	 <link rel="icon" type="image/png" sizes="32x32" href="/images/logos/favicon_package_v0.16_bw/favicon-32x32.png">
	 <link rel="icon" type="image/png" sizes="16x16" href="/images/logos/favicon_package_v0.16_bw/favicon-16x16.png">
	 <link rel="manifest" href="/images/logos/favicon_package_v0.16_bw/site.webmanifest">
	 <meta name="msapplication-TileColor" content="#da532c">
	 <meta name="theme-color" content="#ffffff">
	
	 <meta name="viewport" content="width=device-width, initial-scale=1">
	
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="description" content="A home for topics in human precision medicine, genomic analysis, and data visualisation.">
	<title>Multiple linear regression</title>
	<meta name="author" content="LawlessGenomics">
	<link href="https://lawlessgenomics.com/feed.xml" rel="alternate" title="LawlessGenomics" type="application/atom+xml">
	<!-- <meta name="readability-verification" content="QCzSs992GxmRYRKVpPeZ6LE2tS8aYKxsSSQKV8YM"/> -->
	
	<!-- include a google font -->
	<link href="https://fonts.googleapis.com/css?family=Roboto+Mono%7CRoboto+Slab:300%7CRoboto:500" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lora" rel="stylesheet">
	
	<!-- syntax highlighting CSS -->
	<link rel="stylesheet" href="/css/syntax.css" type="text/css">
	
	<!-- Homepage CSS -->
	<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection">
	
	<!-- Google font -->
	<link rel="preconnect" href="https://fonts.googleapis.com"> 
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
	<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" rel="stylesheet">
	
	<!-- Typekit -->
	<script type="text/javascript" src="https://use.typekit.com/jpd0pfm.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>

<!-- ClickTale Top part -->
<script type="text/javascript">
	var WRInitTime=(new Date()).getTime();
</script>
<!-- ClickTale end of Top part -->

<!-- Logo and navigation bar -->



<!-- SITE START --------------------------------------------------------- -->
<div class="site">

<!-- NAV START --------------------------------------------------------- -->
<div class="sitewidthnav">
	<div class="title">
		<div class="nav-container">
			<nav>

			<div class="logoimage">
				<a href="/">
				<img style="margin-bottom:-16px" src="/images/logos/logo4.2_150ppi.png" alt="Logo image" width="25" height="38.5"></a>
				<!-- alt="Logo image" width="35.7" height="55" /></a> -->
			</div>

			<div class="logo">
				<a href="/">LawlessGenomics</a>
			</div>

				<input type="checkbox" id="nav-toggle">
					<label for="nav-toggle" class="gg-menu"></label>
					<div class="right-menu">
						<a href="/resume">About</a>
						<a href="/">Home</a>
					</div>
			</nav>
		</div>
	</div>



</div>
<!-- NAV END ----------------------------------------------------------- -->

<!-- MAIN START -------------------------------------------------------- -->
<div class="sitewidth">
	<div id="topic">
Reading time  11 minutes
<h1 id="multiple-linear-regression">Multiple linear regression</h1>
<ul id="markdown-toc">
  <li><a href="#multiple-linear-regression-1" id="markdown-toc-multiple-linear-regression-1">Multiple Linear Regression</a></li>
  <li><a href="#estimating-the-regression-coefficients" id="markdown-toc-estimating-the-regression-coefficients">Estimating the Regression Coefficients</a></li>
  <li><a href="#some-important-questions" id="markdown-toc-some-important-questions">Some Important Questions</a></li>
  <li><a href="#one-is-there-a-relationship-between-the-response-and-predictors" id="markdown-toc-one-is-there-a-relationship-between-the-response-and-predictors">One: Is There a Relationship Between the Response and Predictors?</a></li>
  <li><a href="#five-model-fit" id="markdown-toc-five-model-fit">Five: Model Fit</a></li>
  <li><a href="#six-model-fit" id="markdown-toc-six-model-fit">Six: Model Fit</a></li>
  <li><a href="#four-predictions" id="markdown-toc-four-predictions">Four: Predictions</a></li>
</ul>

<p>This page is based on “An Introduction to Statistical Learning”.</p>

<h2 id="multiple-linear-regression-1">Multiple Linear Regression</h2>

<p>In practice, we often have more than one predictor. 
For example, in the Advertising data, we have data for the amount of money spent advertising on the radio and in newspapers, besides TV advertising. 
Instead of fitting a separate simple linear regression model for each predictor, a better approach is to extend the simple linear regression model to directly accommodate multiple predictors by giving each predictor a separate slope coefficient in a single model.</p>

<p>In general, if we have p distinct predictors, the multiple linear regression model takes the form:</p>

\[Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_p X_p + \epsilon\]

<p>Where \(X_j\) represents the jth predictor and \(\beta_j\) quantifies the association between that variable and the response. 
We interpret \(\beta_j\) as the average effect on Y of a one-unit increase in \(X_j\), holding all other predictors fixed. 
In the advertising example:</p>

\[\text{sales} = \beta_0 + \beta_1 \times \text{TV} + \beta_2 \times \text{radio} + \beta_3 \times \text{newspaper} + \epsilon\]

<h2 id="estimating-the-regression-coefficients">Estimating the Regression Coefficients</h2>

<p>In multiple linear regression, the regression coefficients are unknown and must be estimated. 
Given estimates \(\hat{\beta}_0\), \(\hat{\beta}_1\), …, \(\hat{\beta}_p\), we can make predictions using the formula:</p>

\[\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \hat{\beta}_2 x_2 + \cdots + \hat{\beta}_p x_p\]

<p>The parameters are estimated using the same least squares approach as in simple linear regression. 
We choose \(\beta_0\), \(\beta_1\), …, \(\beta_p\) to minimize the sum of squared residuals:</p>

\[RSS = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2 = \sum_{i=1}^{n} (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_{i1} - \hat{\beta}_2 x_{i2} - \cdots - \hat{\beta}_p x_{ip})^2\]

<p>The values \(\hat{\beta}_0\), \(\hat{\beta}_1\), …, \(\hat{\beta}_p\) that minimize the sum of squared residuals are the multiple least squares regression coefficient estimates. 
These estimates have more complicated forms than those in simple linear regression and are most easily represented using matrix algebra.</p>

<p>In the Advertising data example, the multiple regression coefficient estimates for TV, radio, and newspaper advertising budgets are interpreted as follows: for a given amount of TV and newspaper advertising, spending an additional $1,000 on radio advertising leads to an increase in sales by approximately 189 units. 
This illustrates that the simple and multiple regression coefficients can be quite different.</p>

<h2 id="some-important-questions">Some Important Questions</h2>

<p>When performing multiple linear regression, we usually are interested in answering a few important questions:</p>

<ol>
  <li>Is at least one of the predictors \(X_1\), \(X_2\), …, \(X_p\) useful in predicting the response?</li>
  <li>Do all the predictors help to explain Y, or is only a subset of the predictors useful?</li>
  <li>How well does the model fit the data?</li>
  <li>Given a set of predictor values, what response value should we predict, and how accurate is our prediction?</li>
</ol>

<p>We will address each of these questions in the following sections.</p>

<h2 id="one-is-there-a-relationship-between-the-response-and-predictors">One: Is There a Relationship Between the Response and Predictors?</h2>

<p>Recall that in the simple linear regression setting, in order to determine whether there is a relationship between the response and the predictor we can simply check whether \(\beta_1 = 0\). 
In the multiple regression setting with \(p\) predictors, we need to ask whether all of the regression coefficients are zero, i.e. 
whether \(\beta_1 = \beta_2 = \cdots = \beta_p = 0\). 
As in the simple linear regression setting, we use a hypothesis test to answer this question. 
We test the null hypothesis,</p>

\[H_0 : \beta_1 = \beta_2 = \cdots = \beta_p = 0\]

<p>versus the alternative</p>

\[H_a : \text{at least one } \beta_j \text{ is non-zero.}\]

<p>This hypothesis test is performed by computing the F-statistic,</p>

\[F = \frac{(TSS - RSS)/p}{RSS/(n - p - 1)}\]

<p>where, as with simple linear regression, \(TSS = \sum(y_i - \bar{y})^2\) and \(RSS = \sum(y_i - \hat{y}_i)^2\). 
If the linear model assumptions are correct, one can show that</p>

\[E\left\{\frac{RSS}{(n - p - 1)}\right\} = \sigma^2 \quad \text{and that, provided } H_0 \text{ is true, }\]

\[E\left\{\frac{(TSS - RSS)}{p}\right\} = \sigma^2.\]

<p>Hence, when there is no relationship between the response and predictors, one would expect the F-statistic to take on a value close to 1. 
On the other hand, if \(H_a\) is true, then \(E\{(TSS - RSS)/p\} &gt; \sigma^2\), so we expect F to be greater than 1.</p>

<p>When \(H_0\) is true and the errors \(\epsilon_i\) have a normal distribution, the F-statistic follows an F-distribution. 
For any given value of \(n\) and \(p\), any statistical software package can be used to compute the p-value associated with the F-statistic using this distribution. 
Based on this p-value, we can determine whether or not to reject \(H_0\).</p>

<p>Sometimes we want to test that a particular subset of \(q\) of the coefficients are zero. 
This corresponds to a null hypothesis</p>

\[H_0 : \beta_{p - q + 1} = \beta_{p - q + 2} = \cdots = \beta_p = 0,\]

<p>where for convenience we have put the variables chosen for omission at the end of the list. 
In this case we fit a second model that uses all the variables except those last \(q\). 
Suppose that the residual sum of squares for that model is \(RSS_0\). 
Then the appropriate F-statistic is</p>

\[F = \frac{(RSS_0 - RSS)/q}{RSS/(n - p - 1)}.\]

<p>The F-statistic adjusts for the number of predictors. 
Hence, if \(H_0\) is true, there is only a 5% chance that the F-statistic will result in a p-value below 0.05, regardless of the number of predictors or the number of observations.</p>

<h2 id="five-model-fit">Five: Model Fit</h2>

<p>Once we have selected the variables to be included in the model, the next step is to assess how well the model fits the data. 
The most common way to do this is by examining the residual plot. 
The residual plot shows the difference between the predicted values of the response and the actual values of the response. 
If the model fits the data well, then the residuals should be randomly scattered around zero, with no discernible pattern. 
If there is a pattern in the residual plot, then it suggests that the model is not capturing some important aspect of the data.</p>

<p>Another way to assess model fit is by computing the R-squared value. 
Recall that the R-squared value measures the proportion of variability in the response that is explained by the model. 
A high R-squared value suggests that the model fits the data well, while a low R-squared value suggests that the model does not fit the data well.</p>

<p>In multiple regression, we use the adjusted R-squared value instead of the regular R-squared value. 
The adjusted R-squared value takes into account the number of variables in the model and adjusts the R-squared value downward if additional variables are added that do not contribute to the fit of the model. 
The adjusted R-squared value is given by:</p>

\[\text{Adjusted R}^2 = 1 - \frac{n-1}{n-p}(1-R^2)\]

<p>where \(n\) is the sample size and \(p\) is the number of predictors in the model.</p>

<p>It is important to note that a high R-squared or adjusted R-squared value does not necessarily mean that the model is a good fit for the data. 
It is possible to have a high R-squared value even if the model does not fit the data well. 
Therefore, it is important to also examine the residual plot to ensure that the model is capturing all of the important aspects of the data.</p>

<p>Finally, it is important to keep in mind that there are limitations to using linear regression to model complex relationships. 
Linear regression assumes that the relationship between the response and the predictors is linear, and that the errors are normally distributed with constant variance. 
If these assumptions are not met, then the model may not fit the data well and the results may not be reliable. 
In such cases, more advanced techniques such as nonlinear regression or generalized linear models may be necessary.</p>

<h2 id="six-model-fit">Six: Model Fit</h2>

<p>In multiple linear regression, we use the RSE (Residual Standard Error) and R2 statistics to assess the model fit. 
The R2 statistic measures the proportion of variance in the response that is explained by the model, and is given by:</p>

\[R^2 = Cor(Y, \hat{Y})^2\]

<p>where \(Y\) is the response variable and \(\hat{Y}\) is the predicted response variable. 
A high R2 value indicates that the model explains a large portion of the variance in the response variable.</p>

<p>The RSE statistic measures the standard deviation of the residuals, and is given by:</p>

\[RSE = \sqrt{\frac{RSS}{n-p-1}}\]

<p>where \(RSS\) is the residual sum of squares, \(n\) is the sample size, and \(p\) is the number of predictors in the model. 
A low RSE value indicates that the model has a small standard deviation of the residuals and is a better fit to the data.</p>

<p>It is important to note that a high R2 or low RSE value does not necessarily mean that the model is a good fit for the data. 
It is possible to have a high R2 or low RSE value even if the model does not fit the data well. 
Therefore, it is important to also examine the residual plot to ensure that the model is capturing all of the important aspects of the data.</p>

<p>In addition to numerical measures of model fit, graphical summaries can also be useful in identifying problems with the model that are not visible from numerical statistics. 
For example, a three-dimensional plot of the predictors versus the response variable can reveal non-linear patterns or interactions between predictors that cannot be modeled accurately using linear regression.</p>

<p>Overall, while linear regression can be a powerful tool for modeling relationships between variables, it is important to carefully assess model fit and to consider more advanced techniques if the assumptions of linear regression are not met.</p>

<h2 id="four-predictions">Four: Predictions</h2>
<p>Once we have fit the multiple regression model, it is straightforward to apply the earlier eqn in order to predict the response \(Y\) on the basis of a set of values for the predictors X1, X2, …, Xp. 
However, there are three sorts of uncertainty associated with this prediction.</p>
<ol>
  <li>The coefficient estimates \(\hat{\beta_0}\), \(\hat{\beta_1}\),…, \(\hat{\beta_p}\) are estimates for \(\beta_0\), \(\beta_1\),…, \(\beta_p\). 
That is, the least squares plane
\(\hat{Y} = \hat{\beta_0} + \hat{\beta_1}X_1 + · · · + \hat{\beta_p}X_p\)
is only an estimate for the true population regression plane
\(f(X)=\beta_0 +\beta_1X_1 +···+\beta_pX_p.\)
The inaccuracy in the coefficient estimates is related to the reducible error from Chapter 2. 
We can compute a confidence interval in order to determine how close \(\hat{Y}\) will be to \(f(X)\).</li>
  <li>
    <p>Of course, in practice assuming a linear model for \(f(X)\) is almost always an approximation of reality, so there is an additional source of potentially reducible error which we call model bias. 
So when we use a linear model, we are in fact estimating the best linear approximation to the true surface. 
However, here we will ignore this discrepancy, and operate as if the linear model were correct.</p>
  </li>
  <li>Even if we knew \(f(X)\)—that is, even if we knew the true values for \(\beta_0\),\(\beta_1\),…,\(\beta_p\)—the response value cannot be predicted perfectly because of the random error \(\varepsilon\) in the model (3.21). 
This is called an irreducible error. 
How much will Y vary from \(\hat{Y}\)? We use prediction intervals to answer this question. 
Prediction intervals are always wider than confidence intervals, because they incorporate both the error in the estimate for \(f(X)\) (the reducible error) and the uncertainty as to how much an individual point will differ from the population regression plane (the irreducible error).</li>
</ol>

<p>We use a confidence interval to quantify the uncertainty surrounding the average sales over a large number of cities. 
For example, given that $100,000 is spent on TV advertising and $20,000 is spent on radio advertising in each city, the 95 % confidence interval is [10,985, 11,528]. 
We interpret this to mean that 95 % of intervals of this form will contain the true value of \(f(X)\). 
On the other hand, a prediction interval can be used to quantify the uncertainty surrounding sales for a particular city. 
Given that $100,000 is spent on TV advertising and $20,000 is spent on radio advertising in that city the 95 % prediction interval is [7,930, 14,580]. 
We interpret this to mean that 95 % of intervals of this form will contain the true value of \(Y\) for this city. 
Note that both intervals are centered at 11,256, but that the prediction interval is substantially wider than the confidence interval, reflecting the increased uncertainty about sales for a given city in comparison to the average sales over many locations.</p>


</div>

<!--

<div id="related">
  <h2>Related Topics</h2>
  <ul class="topics">
    
  </ul>
</div>

-->

















</div>
<!-- # MAIN END ---------------------------------------------------------- -->

<!-- FOOT START -------------------------------------------------------- -->
<div class="sitewidthnav">
	<div class="footer">
		<div class="foot-container">
				<a href="/" class="logo-foot">
				<img style="margin-bottom:-16px" src="/images/logos/logo4.2_150ppi.png" alt="Logo image" width="25" height="38.5"></a>
					<div class="right-root">
						<p><a href="https://github.com/DylanLawless/DylanLawless.github.io/tree/source">Maintained</a> by Dylan Lawless. Scientist at <a href="https://people.epfl.ch/dylan.lawless">EPFL</a>.
						<a href="/resume">Resume</a>
						and <a href="https://scholar.google.com/citations?user=RPBxP1wAAAAJ&hl=en&oi=ao">Google scholar</a>.
						<a href="https://lawlessgenomics.com/feed.xml">RSS feed</a>
						</p>
					</div>
		</div>
	</div>
</div>
<!-- FOOT END ---------------------------------------------------------- -->

</div>
<!-- SITE END ----------------------------------------------------------- -->


<!-- Banner on top right corner linking to github
<a href="https://github.com/mojombo"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
-->

<!-- ClickTale Bottom part -->
<div id="ClickTaleDiv" style="display: none;"></div>
<script type="text/javascript">
if(document.location.protocol!='https:')
  document.write(unescape("%3Cscript%20src='https://s.clicktale.net/WRb.js'%20type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
if(typeof ClickTale=='function') ClickTale(206,0.3,"www03");
</script>
<!-- ClickTale end of Bottom part -->

<!-- Google Analytics -->
<!--
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "https://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6016902-1");
pageTracker._trackPageview();
</script>
-->
<!-- Google Analytics end -->

</body>
</html>
