<!DOCTYPE html>
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
	<!-- link to MathJax for LaTeX stlye eqn -->
	 <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
</script>

	 
	 <!-- https://realfavicongenerator.net -->
	 <link rel="apple-touch-icon" sizes="180x180" href="/images/logos/favicon_package_v0.16_bw/apple-touch-icon.png">
	 <link rel="icon" type="image/png" sizes="32x32" href="/images/logos/favicon_package_v0.16_bw/favicon-32x32.png">
	 <link rel="icon" type="image/png" sizes="16x16" href="/images/logos/favicon_package_v0.16_bw/favicon-16x16.png">
	 <link rel="manifest" href="/images/logos/favicon_package_v0.16_bw/site.webmanifest">
	 <meta name="msapplication-TileColor" content="#da532c">
	 <meta name="theme-color" content="#ffffff">
	
	 <meta name="viewport" content="width=device-width, initial-scale=1">
	
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="description" content="A home for topics in human precision medicine, genomic analysis, and data visualisation.">
	<title>Zero-inflated negative binomial regression</title>
	<meta name="author" content="LawlessGenomics">
	<link href="https://lawlessgenomics.com/feed.xml" rel="alternate" title="LawlessGenomics" type="application/atom+xml">
	<!-- <meta name="readability-verification" content="QCzSs992GxmRYRKVpPeZ6LE2tS8aYKxsSSQKV8YM"/> -->
	
	<!-- include a google font -->
	<link href="https://fonts.googleapis.com/css?family=Roboto+Mono%7CRoboto+Slab:300%7CRoboto:500" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lora" rel="stylesheet">
	
	<!-- syntax highlighting CSS -->
	<link rel="stylesheet" href="/css/syntax.css" type="text/css">
	
	<!-- Homepage CSS -->
	<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection">
	
	<!-- Typekit -->
	<script type="text/javascript" src="https://use.typekit.com/jpd0pfm.js"></script>
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body>

<!-- ClickTale Top part -->
<script type="text/javascript">
	var WRInitTime=(new Date()).getTime();
</script>
<!-- ClickTale end of Top part -->

<!-- Logo and navigation bar -->
<div class="site">
	<div class="title">
		<div class="nav-container">
			<nav>

			<div class="logoimage">
				<a href="/">
				<img style="margin-bottom:-16px" src="/images/logos/logo4.1_150ppi.png" alt="Logo image" width="35.7" height="55"></a>
			</div>

			<div class="logo">
				<a href="/">LawlessGenomics</a>
			</div>

				<input type="checkbox" id="nav-toggle">
					<label for="nav-toggle" class="gg-menu"></label>
					<div class="right-menu">
						<a href="/resume">About</a>
						<a href="/">Home</a>
					</div>
			</nav>
		</div>
	</div>

	<div id="topic">
Reading time 4 minutes
<h1 id="zero-inflated-negative-binomial-regression">Zero-inflated negative binomial regression</h1>
<ul id="markdown-toc">
  <li>
<a href="#zero-inflated-negative-binomial-regression-1" id="markdown-toc-zero-inflated-negative-binomial-regression-1">Zero-inflated negative binomial regression</a>    <ul>
      <li><a href="#a-negative-binomial-model" id="markdown-toc-a-negative-binomial-model">A negative binomial model.</a></li>
    </ul>
  </li>
  <li><a href="#analysis-methods-you-might-consider" id="markdown-toc-analysis-methods-you-might-consider">Analysis methods you might consider</a></li>
</ul>

<h2 id="zero-inflated-negative-binomial-regression-1">Zero-inflated negative binomial regression</h2>

<p>Zero-inflated negative binomial regression (zinbr) is for modeling count variables with excessive zeros and it is usually for overdispersed count outcome variables.</p>

<p>The excess zeros are generated by a process that can be explained separately from the count values. The excess zeros can be modeled independently.</p>

<p>We have data on 250 groups that went to a park. 
Fish count - how many fish a group caught
Child count - how many children were in the group, 
Person count  - many people were in the group, 
Camper binary - whether or not they brought a camper to the park.</p>

<p>In addition to predicting the number of fish caught, 
there is interest in predicting the existence of excess zeros, i.e., the probability that a group caught zero fish.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">zinb</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"https://stats.idre.ucla.edu/stat/data/fish.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">zinb</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">within</span><span class="p">(</span><span class="n">zinb</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">nofish</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">nofish</span><span class="p">)</span><span class="w">
  </span><span class="n">livebait</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">livebait</span><span class="p">)</span><span class="w">
  </span><span class="n">camper</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">camper</span><span class="p">)</span><span class="w">
</span><span class="p">})</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">zinb</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>A zero-inflated model assumes that zero outcome is due to two different processes.</p>

<ul>
  <li>a subject has gone fishing vs.</li>
  <li>not gone fishing.</li>
</ul>

<p>If gone fishing = count process.
If not gone fishing = the only outcome possible is zero.</p>

<p>The two parts of the a zero-inflated model are</p>
<ol>
  <li>Binary model
    <ul>
      <li>usually a logit model: models which of the two processes the zero outcome is associated with.</li>
    </ul>
  </li>
  <li>Count model
    <ul>
      <li>in this case, a negative binomial model: models the count process.</li>
    </ul>
  </li>
</ol>

<p>The expected count is expressed as a combination of the two processes.</p>

<p>Taking the example of fishing again:</p>

<p>$
E(n_{\text{fish caught}} = k) = P(\text{not gone fishing}) * 0 + P(\text{gone fishing}) * E(y = k | \text{gone fishing})
$</p>

<h3 id="a-negative-binomial-model">A negative binomial model.</h3>
<p>There are multiple parameterizations of the negative binomial model, 
we focus on NB2. 
The negative binomial probability density function is:</p>

<p>$
PDF(y; p, r) = \frac{(y_i + r – 1)!}{y_i!(r-1)!}p_{i}^{r}(1 – p_i)^{y_i}
$
where  (p) is the probability of (r) successes.</p>

<p>From this we can derive the likelihood function, which is given by:
$
L(\mu; y, \alpha) = \prod_{i=1}^{n}exp\left(y_i ln\left(\frac{\alpha\mu_i}{1 +\alpha\mu_i}\right)-\frac{1}{\alpha}ln(1 + \alpha\mu_i) + ln\Gamma(y_i + \frac{1}{\alpha})-ln\Gamma(y_i + 1) – ln\Gamma(\frac{1}{\alpha})\right)
$</p>

<p>here we find the likelihood of the expected value, 
\(\mu\) (mu)
 given the data and 
\(\alpha\) (alpha)
which allows for dispersion. 
Typically, this would be expressed as a log likelihood, denoted by
\(\mathcal{L}\)
(script L)
(<a href="https://stats.stackexchange.com/questions/284816/why-do-people-use-mathcall-thetax-for-likelihood-instead-of-px-theta">sidenote</a>):</p>

<p>$
\mathcal{L}(\mu; y, \alpha) = \sum_{i=1}^{n}y_i ln\left(\frac{\alpha\mu_i}{1 + \alpha\mu_i}\right)-\frac{1}{\alpha}ln(1 + \alpha\mu_i) + ln\Gamma(y_i + \frac{1}{\alpha})-ln\Gamma(y_i + 1) – ln\Gamma(\frac{1}{\alpha})
$</p>

<p>which can be expressed in terms of our model by replacing
\(\mu_i\)
with 
\(exp(x_i'\beta)\).</p>

<p>Turning to the zero-inflated negative binomial model, 
the expression of the likelihood function depends on whether the observed value is a zero or greater than zero. 
From the logistic model of 
\(y_i &gt; 1\) versus \(y = 0\):</p>

<p>$p = \frac{1}{1 + e^{-x_i’\beta}}$ 
and 
$1 - p = \frac{1}{1 + e^{x_i’\beta}}$ then</p>

<p>$
\mathcal{L} = \left{ \begin{array}{ll} \sum_{i=1}^{n} \left[ ln(p_{i}) + (1 – p_i)\left(\frac{1}{1 + \alpha\mu_{i}}\right)^{\frac{1}{\alpha}} \right] &amp;\mbox{if } y_{i} = 0 <br>
\sum_{i=1}^{n} \left[ ln(p_{i}) + ln\Gamma\left(\frac{1}{\alpha} + y_i\right) – ln\Gamma(y_i + 1) – ln\Gamma\left(\frac{1}{\alpha}\right) + \left(\frac{1}{\alpha}\right)ln\left(\frac{1}{1 + \alpha\mu_{i}}\right) + y_iln\left(1 – \frac{1}{1 + \alpha\mu_{i}}\right) \right] &amp;\mbox{if } y_{i} &gt; 0 \end{array} \right. ] ]
$</p>

<p>Finally, note that R does not estimate 
\(\alpha\)
 but its inverse:
 \(\theta\).</p>

<p>Now let’s build up our model. 
We are going to use the variables</p>
<ul>
  <li>child and</li>
  <li>camper 
to model the count in the part of negative binomial model and the</li>
  <li>variable persons 
in the logit part of the model.
We use the pscl to run a zero-inflated negative binomial regression. We begin by estimating the model with the variables of interest.</li>
</ul>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">zeroinfl</span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">camper</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">persons</span><span class="p">,</span><span class="w">
  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zinb</span><span class="p">,</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"negbin"</span><span class="p">,</span><span class="w"> </span><span class="n">EM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
  </span><span class="n">summary</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<h2 id="analysis-methods-you-might-consider">Analysis methods you might consider</h2>
<p>Some other methods that you might use.</p>

<p>OLS Regression – You could try to analyze these data using OLS regression. However, count data are highly non-normal and are not well estimated by OLS regression.
Zero-inflated Poisson Regression – Zero-inflated Poisson regression does better when the data is not overdispersed, i.e. when variance is not much larger than the mean.
Ordinary Count Models – Poisson or negative binomial models might be more appropriate if there are not excess zeros.</p>


</div>

<!--

<div id="related">
  <h2>Related Topics</h2>
  <ul class="topics">
    
  </ul>
</div>

-->


















	<div class="footer">
		<div class="foot-container">
				<a href="/" class="logo-foot">
				<img style="margin-bottom:-16px" src="/images/logos/logo4.2_150ppi.png" alt="Logo image" width="35.7" height="55"></a>
					<div class="right-root">
						<p> Maintained by Dylan Lawless. Postdoc at <a href="https://people.epfl.ch/dylan.lawless">EPFL</a>.
						<a href="/resume">Resume</a>
						and <a href="https://scholar.google.com/citations?user=RPBxP1wAAAAJ&hl=en&oi=ao">Google scholar</a>.
						<a href="https://lawlessgenomics.com/feed.xml">RSS feed</a>
						</p>
					</div>
		</div>
	</div>

</div>


<!-- Banner on top right corner linking to github
<a href="https://github.com/mojombo"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
-->

<!-- ClickTale Bottom part -->
<div id="ClickTaleDiv" style="display: none;"></div>
<script type="text/javascript">
if(document.location.protocol!='https:')
  document.write(unescape("%3Cscript%20src='https://s.clicktale.net/WRb.js'%20type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
if(typeof ClickTale=='function') ClickTale(206,0.3,"www03");
</script>
<!-- ClickTale end of Bottom part -->

<!-- Google Analytics -->
<!--
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "https://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-6016902-1");
pageTracker._trackPageview();
</script>
-->
<!-- Google Analytics end -->

</body>
</html>
